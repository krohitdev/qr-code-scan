<!DOCTYPE html>
<html>

<head>
  <title>QR Code Scanner</title>
  
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>

<body>
  <button id="scanButton">Scan QR Code</button>
  <div id="qrResult" style="width:500px"></div>
  <div id="action"></div>

  <script>
    const scanButton = document.getElementById('scanButton');
    const qrResultContainer = document.getElementById('qrResult');

    scanButton.addEventListener('click', () => {
    /*  const html5QrcodeScanner = new Html5QrcodeScanner(
        'qrResult',
        { fps: 10, qrbox: 250,
          rememberLastUsedCamera: true,
  // Only support camera scan type.
  supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA] },
        
        { facingMode: 'environment' } // Specify the camera facing mode
      );

      html5QrcodeScanner.render(onScanSuccess);

      function onScanSuccess(decodedText,decodedResult) {
        qrResultContainer.innerHTML = `Scanned QR Code: ${decodedText}`;
        console.log(`Code matched = ${decodedText}`, decodedResult);
        html5QrcodeScanner.clear();
        alert(`Scan result ${qrCodeMessage}`);
      } */

      const html5QrCode = new Html5Qrcode(
        "qrResult", { formatsToSupport: [Html5QrcodeSupportedFormats.QR_CODE] });

      const qrCodeSuccessCallback = (decodedText, decodedResult) => {
        /* handle success */
      console.log(`Scan result ${decodedText}`, decodedResult);
        $('#action').append(`<br/>Start Scanning`);
                $('#action').html(`<br/>Scan result ${decodedText}`);
        
         html5QrCode.stop().then((ignore) => {
          // QR Code scanning is stopped.
        //  alert('camera stopeed');
            $('#action').append(`<br/>camera stopeed`);
        })
      };
      const config = { fps: 10, qrbox: { width: 350, height: 350 } };

      // If you want to prefer front camera
      html5QrCode.start({ facingMode: "environment" }, config, qrCodeSuccessCallback); 
      
  

    });

    
  </script>
  <script src="https://cloud.optimiser.com/lib/jquery-3.3.1.min.js"></script>
  <script src="https://raw.githubusercontent.com/marcusbelcher/cordova-getUserMedia-test/master/www/js/index.js"></script>
</body>

</html>
